<script>
    $(document).ready(function() {
        // Обработка нажатия кнопки "Сравнить"
        $('#compare-btn').click(function() {
            const team1 = $('#team1').val();
            const team2 = $('#team2').val();

            if (!team1 || !team2) {
                alert('Выберите обе команды!');
                return;
            }

            // Запрос данных о матчах команд
            $.get(`/compare?team1=${team1}&team2=${team2}`, function(data) {
                // Отображение результатов
                $('#team1-results').html(`
                    <h4>${team1}</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Дата</th>
                                <th>Соперник</th>
                                <th>Счет</th>
                                <th>Тип матча</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.team1_matches.map(match => `
                                <tr>
                                    <td>${match.date}</td>
                                    <td>${match.opponent}</td>
                                    <td>${match.score}</td>
                                    <td>${match.match_type}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `);

                $('#team2-results').html(`
                    <h4>${team2}</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Дата</th>
                                <th>Соперник</th>
                                <th>Счет</th>
                                <th>Тип матча</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.team2_matches.map(match => `
                                <tr>
                                    <td>${match.date}</td>
                                    <td>${match.opponent}</td>
                                    <td>${match.score}</td>
                                    <td>${match.match_type}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `);

                // Отображение матчей между командами
                $('#head-to-head-matches').html(`
                    ${data.head_to_head_matches.map(match => `
                        <tr>
                            <td>${match.date}</td>
                            <td>${match.opponent}</td>
                            <td>${match.score}</td>
                            <td>${match.match_type}</td>
                        </tr>
                    `).join('')}
                `);

                // Создание графиков
                const winsChart = new Chart(document.getElementById('winsChart'), {
                    type: 'bar',
                    data: {
                        labels: [team1, team2],
                        datasets: [{
                            label: 'Победы',
                            data: [data.stats.wins_team1, data.stats.wins_team2],
                            backgroundColor: ['rgba(54, 162, 235, 0.2)', 'rgba(255, 99, 132, 0.2)'],
                            borderColor: ['rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                const goalsChart = new Chart(document.getElementById('goalsChart'), {
                    type: 'bar',
                    data: {
                        labels: [team1, team2],
                        datasets: [{
                            label: 'Голы',
                            data: [data.stats.goals_team1, data.stats.goals_team2],
                            backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)'],
                            borderColor: ['rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        });
    });
</script>